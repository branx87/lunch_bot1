# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å —á–∞—Å–æ–≤—ã–º –ø–æ—è—Å–æ–º

## –ü—Ä–æ–±–ª–µ–º–∞

Cron –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π:
- –ó–∞–¥–∞—á–∞ –≤ 9:00 —Å—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∞ –≤ 10:40 (–æ–ø–æ–∑–¥–∞–Ω–∏–µ 1—á 40–º–∏–Ω)
- –ó–∞–¥–∞—á–∞ –≤ 9:31 —Å—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∞ –≤ 11:11 (–æ–ø–æ–∑–¥–∞–Ω–∏–µ 1—á 40–º–∏–Ω)
- –ó–∞–¥–∞—á–∞ –≤ 9:21 —Ä–∞–±–æ—Ç–∞–ª–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## –ü—Ä–∏—á–∏–Ω–∞

1. **BitrixSync (APScheduler)** - –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ —Å–æ–∑–¥–∞–≤–∞–ª—Å—è –ë–ï–ó —É–∫–∞–∑–∞–Ω–∏—è timezone
2. **CronManager (aiocron)** - –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ aiocron –∏–º–µ–µ—Ç –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π —á–∞—Å–æ–≤—ã—Ö –ø–æ—è—Å–æ–≤

## –†–µ—à–µ–Ω–∏–µ

### 1. –ó–∞–º–µ–Ω–∏–ª–∏ aiocron –Ω–∞ APScheduler

**–ë—ã–ª–æ** (cron_jobs.py):
```python
import aiocron
self.jobs = []
self.jobs.append(aiocron.crontab(
    f'{TIME_CONFIG.MORNING_REMINDER_TIME.minute} {TIME_CONFIG.MORNING_REMINDER_TIME.hour} * * {work_days}',
    func=self._morning_reminder,
    tz=TIME_CONFIG.TIMEZONE
))
```

**–°—Ç–∞–ª–æ** (cron_jobs.py):
```python
from apscheduler.schedulers.asyncio import AsyncIOScheduler
self.scheduler = AsyncIOScheduler(timezone=TIME_CONFIG.TIMEZONE)
self.scheduler.add_job(
    self._morning_reminder,
    'cron',
    minute=TIME_CONFIG.MORNING_REMINDER_TIME.minute,
    hour=TIME_CONFIG.MORNING_REMINDER_TIME.hour,
    day_of_week=work_days_cron,
    second=0
)
```

### 2. –î–æ–±–∞–≤–∏–ª–∏ timezone –≤ BitrixSync

**–ë—ã–ª–æ** (bitrix/sync.py):
```python
self.scheduler = AsyncIOScheduler()
```

**–°—Ç–∞–ª–æ** (bitrix/sync.py):
```python
self.scheduler = AsyncIOScheduler(timezone=TIME_CONFIG.TIMEZONE)
```

### 3. –û–±–Ω–æ–≤–∏–ª–∏ requirements.txt

–£–±—Ä–∞–ª–∏ `aiocron>=1.8`, —Ç–∞–∫ –∫–∞–∫ —Ç–µ–ø–µ—Ä—å –≤–µ–∑–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ `apscheduler`.

## –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Å–µ –∑–∞–¥–∞—á–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç timezone `Europe/Moscow`:

- **09:00** - –£—Ç—Ä–µ–Ω–Ω–∏–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è (–ü–Ω-–ü—Ç)
- **09:21** - –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–∫–∞–∑–æ–≤ –≤ Bitrix (–ü–Ω-–ü—Ç)
- **09:31** - –£—Ç—Ä–µ–Ω–Ω–∏–µ –æ—Ç—á–µ—Ç—ã (–ü–Ω-–ü—Ç)
- **11:00** - –ë—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏–π –æ—Ç—á–µ—Ç (28-31 —á–∏—Å–ª–∞)
- **18:00** - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ (–ü–Ω-–ü—Ç)
- **03:00** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±–µ–∫–∞–ø (–∫–∞–∂–¥—ã–π –¥–µ–Ω—å)

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Ç–µ—Å—Ç–æ–≤–∞—è –∑–∞–¥–∞—á–∞ —á–µ—Ä–µ–∑ 3 –º–∏–Ω—É—Ç—ã:
```
üß™ –¢–ï–°–¢: –∑–∞–¥–∞—á–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ HH:MM
‚úÖ –¢–ï–°–¢ –£–°–ü–ï–®–ï–ù: –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç! –í—Ä–µ–º—è: 2026-02-12 HH:MM:SS+03:00
```

## –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å

1. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –Ω–æ–≤—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏:
   ```bash
   docker-compose down
   docker-compose build --no-cache
   docker-compose up -d
   ```

2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ —á–µ—Ä–µ–∑ 3 –º–∏–Ω—É—Ç—ã –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ - –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Ç–µ—Å—Ç–µ.

3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å –≤ 09:00, 09:31 - –∑–∞–¥–∞—á–∏ –¥–æ–ª–∂–Ω—ã —Å—Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ—á–Ω–æ –≤ —Å—Ä–æ–∫.
